<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Excel Viewer – Tabs</title>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

<style>
    body {
        font-family: Arial, sans-serif;
        padding: 20px;
        background: #f5f7fa;
    }

    h1 { margin-bottom: 20px; }

    #tabs {
        margin-top: 25px;
        margin-bottom: 15px;
    }

    .tab-btn {
        padding: 10px 16px;
        margin-right: 8px;
        border: none;
        background: #e2e8f0;
        border-radius: 6px;
        cursor: pointer;
        font-weight: bold;
    }

    .tab-btn.active {
        background: #2563eb;
        color: white;
    }

    .sheet-content {
        display: none;
        padding: 15px;
        background: white;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        margin-top: 10px;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
    }

    table, th, td {
        border: 1px solid #bbb;
        padding: 6px;
    }

    th {
        background: #d9e6ff;
    }
</style>

</head>
<body>

<h1>Đọc Excel – Hiển thị sheet với Tab</h1>

<input type="file" id="excelFile" accept=".xlsx,.xls" />

<div id="tabs"></div>
<div id="result"></div>

<script>
document.getElementById("excelFile").addEventListener("change", function(e) {
    const file = e.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function(evt) {
        const data = evt.target.result;
        const workbook = XLSX.read(data, { type: "binary" });

        const validSheets = ["MON", "TUE", "WED", "THU", "FRI", "SAT", "SUN"];

        const tabsDiv = document.getElementById("tabs");
        const resultDiv = document.getElementById("result");

        tabsDiv.innerHTML = "";
        resultDiv.innerHTML = "";

        let firstSheet = null;

        validSheets.forEach(sheetName => {
            if (workbook.Sheets[sheetName]) {

                // Tạo nút tab
                const btn = document.createElement("button");
                btn.className = "tab-btn";
                btn.textContent = sheetName;
                btn.onclick = () => showSheet(sheetName);
                tabsDiv.appendChild(btn);

                // Tạo nội dung sheet
                const sheet = workbook.Sheets[sheetName];
                const html = XLSX.utils.sheet_to_html(sheet);

                const div = document.createElement("div");
                div.className = "sheet-content";
                div.id = "sheet-" + sheetName;
                div.innerHTML = html;
                resultDiv.appendChild(div);

                if (!firstSheet) firstSheet = sheetName;
            }
        });

        // Hiển thị sheet đầu tiên
        if (firstSheet) showSheet(firstSheet);
    };

    reader.readAsBinaryString(file);
});

function showSheet(name) {
    // Ẩn tất cả sheet
    document.querySelectorAll(".sheet-content").forEach(div => {
        div.style.display = "none";
    });

    // Bỏ active tất cả nút
    document.querySelectorAll(".tab-btn").forEach(btn => {
        btn.classList.remove("active");
    });

    // Hiện sheet được chọn
    document.getElementById("sheet-" + name).style.display = "block";

    // Active nút được chọn
    document.querySelectorAll(".tab-btn").forEach(btn => {
        if (btn.textContent === name) btn.classList.add("active");
    });
}
</script>

</body>
</html>
